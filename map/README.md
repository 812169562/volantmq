Many thanks to https://github.com/cevaris/ordered_map